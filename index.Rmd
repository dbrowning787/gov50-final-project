---
title: "Gov 50 Final Project"
author: "Dillon Browning"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts/Part I

I am interested in exploring data in a few areas. One could potentially be the correspondence of minimum wage and voter preference or drug overdoses. I am not quite sure what necessarily I want to do quite yet.

## Research Idea/Part II
How does access to transportation in rural counties in America influence drug overdose deaths? In America, there is an expanding gap between rural and suburban/urban Americans in economic, healthcare, and educational outcomes. While numerous different policy proposals beginning with those following the Financial Crisis of 2008 have been proposed, there have been mixed outcomes. Over the past year, there have been many debates in Congress on spending and what programs should be pared down. This year representatives (as often happens) continued to look at reducing funding to rural transportation subsidies that thousands of Americans rely upon not only for an easier connection to the country/world, but businesses and other outcomes rely upon peoples ability to access these transportation networks. Areas with worse access to reliable transportation, I believe, are more likely to have a high drug overdose rate. The explanatory variable is the number of people who use transportation (excluding personal vehicle) in a rural county, while the outcome variable is the number of drug overdoses per capita. If overdoses increase as transportation decreases, that would prove my hypothesis; if overdoses increase as transportation decreases, that would disprove my hypothesis.

##Part 3 Data

GEOID: state + count identifier

```{r, FALSE}
library(tidyverse)
library(dplyr)
access <- read.csv("Data/Access_to_Intercity_Air__Bus__and_Rail_Transportation_in_Rural_Areas.csv")|>
  rename(ST_ABBREV = STATEPO, COUNTYNAME = NAME)
```

```{r}
access$RURALPOP <- as.double(access$RURALPOP)
```

```{r, FALSE}
access$GEOID <- as.integer(access$GEOID)

access21 <- access|>
  filter(YEAR  == 2021)|>
  group_by(GEOID)|>
  summarise(total_pop = as.integer(mean(as.integer(TOTPOP))), 
            rural_pop = as.integer(mean(RURALPOP)), 
            perc_sml_airport = mean(as.numeric(PACCAIR)),
            perc_large_airport = mean(as.numeric(PACCAIRL)),
            perc_bus = mean(as.numeric(PACCBUS)), 
            perc_rail = mean(as.numeric(PACCRAIL)), 
            perc_all = mean(as.numeric(PACCALL)),
            perc_poverty_intercity = mean(as.numeric(POV_ANY)),
            perc_l10k_intercity = mean(as.numeric(L10K_ANY)),
            perc_unemp_intercity = mean(as.numeric(UEMP_ANY)),
            perc_unemp = mean(as.numeric(UEMP)),
            perc_poverty = mean(as.numeric(POV)))
            


access21

```
```{r, FALSE}
drug_overdoses <- read.csv("Data/VSRR_Provisional_County-Level_Drug_Overdose_Death_Counts.csv") |>
  rename(drug_deaths = Provisional.Drug.Overdose.Deaths)
drug_overdoses <- drug_overdoses |>
  rename(GEOID = FIPS)

drug_overdoses$drug_deaths <- as.double(drug_overdoses$drug_deaths)

drug_overdoses <- drug_overdoses|>
  mutate(drug_death2 = if_else(Footnote == "One or more data cells have counts between 1-9 and have been suppressed in accordance with NCHS confidentiality standards.", 1, drug_deaths))
  
drug_overdoses$drug_deaths <- as.double(drug_overdoses$drug_deaths)

drug_overdoses

overdoses_2021 <- drug_overdoses |>
  filter(Year == 2021)|>  group_by(GEOID, COUNTYNAME, ST_ABBREV)|>
  summarise(deaths_2021 = sum(drug_death2))

overdoses_2021
  
```
```{r, FALSE}
combined <- access21|>
  left_join(overdoses_2021, by = "GEOID")|>
  select(total_pop:perc_poverty, GEOID:deaths_2021)

combined <- combined |>
  mutate(overdose_rate = (deaths_2021/total_pop)*100000, perc_pop_rural = (rural_pop/total_pop)*100)

combined|>
  filter(perc_all <= 40)|>
  ggplot(mapping = aes(x = perc_all, y = overdose_rate)) + geom_point() + geom_smooth(method = "loess", se = FALSE)

ggplot(data = combined, mapping = aes(x = perc_pop_rural, y = overdose_rate)) + geom_point() + geom_smooth(method = "loess", se = FALSE)
combined
ggplot(data = combined, mapping = aes(x = perc_unemp_intercity, y = overdose_rate))+ geom_point() + geom_smooth(method = "loess", se = FALSE) + scale_x_continuous(limits = c(0, 30))

combined_long <- combined|>
  pivot_longer(cols = c(perc_poverty_intercity, perc_poverty), names_to = "Poverty", values_to = "value")

Poverty_drugs <- ggplot(combined_long, aes(x = value, color = Poverty, y = overdose_rate))+ geom_point(alpha = 0.25) + geom_smooth(method = "loess", se = FALSE)  + scale_x_continuous(limits = c(0, 50)) + labs(title = "Drug Overdose Rate in Relation to Access to Intercity Transit in Rural Areas", x = "Percent of Rural Residents in Poverty in a County", y = "Drug Overdose Rate (per 100000 People)") + scale_color_discrete(labels = c("Percent of Rural Area in Poverty", "Percent of Rural Area in Poverty with Intercity Transit"))

Poverty_drugs

```
```{r}
Poverty_drugs <- ggplot(combined_long, aes(x = value, color = Poverty, y = overdose_rate))+ geom_point(alpha = 0.25) + geom_smooth(method = "loess", se = FALSE)  + scale_x_continuous(limits = c(0, 50)) + labs(title = "Drug Overdose Rate in Relation to Access to Intercity Transit in Rural Areas", x = "Percent of Rural Residents in Poverty in a County", y = "Drug Overdose Rate (per 100000 People)") + scale_color_discrete(labels = c("Percent of Rural Area in Poverty", "Percent of Rural Area in Poverty with Intercity Transit"))

Poverty_drugs
```

